(this["webpackJsonpreact-around-auth"]=this["webpackJsonpreact-around-auth"]||[]).push([[0],{29:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),o=n(18),s=n.n(o),c=(n(29),n(23)),r=n(2),l=n(3),d=n(8),u=n.p+"static/media/logo.4e8e0a1d.svg",m=n.p+"static/media/hamburger_icon_white.a3d24b6c.svg",b=n.p+"static/media/close-icon.2286ad03.svg",h=n(0);var j=function(e){var t=Object(l.g)(),n=i.a.useState(!1),a=Object(r.a)(n,2),o=a[0],s=a[1],c=i.a.useState(!1),j=Object(r.a)(c,2),p=j[0],_=j[1];return i.a.useEffect((function(){function e(){window.matchMedia("(max-width: 550px)").matches?s(!0):s(!1)}return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}})),Object(h.jsxs)("header",{className:"header ".concat(e.loggedIn&&"header__mobile"),children:[Object(h.jsxs)("div",{className:"header__logo-group",children:[Object(h.jsx)("img",{className:"logo",src:u,alt:"logo"}),e.loggedIn&&o&&Object(h.jsx)("img",{className:"".concat(o&&p?"header__close-icon":"header__hamburger-icon"),src:p?b:m,alt:"",onClick:function(){_(!p)}})]}),Object(h.jsxs)("div",{className:"header__info-group ".concat(o&&e.loggedIn&&"header__info-group_type_mobile"," ").concat(o&&!p&&e.loggedIn&&"mobile-menu"),children:[e.loggedIn&&Object(h.jsx)("p",{className:"header__email",children:"cjmaret@gmail.com"}),Object(h.jsx)(d.b,{className:"header__link ".concat(o&&e.loggedIn&&"header__link_type_mobile"," ").concat(e.loggedIn?"header__link_type_grey":"header__link_type_white"),to:e.pageLink,onClick:function(){localStorage.removeItem("jwt"),console.log("jwt removed"),t.push("/login")},children:e.linkTitle})]})]})},p=i.a.createContext();var _=function(e){var t,n,a=i.a.useContext(p),o=(null===(t=e.card)||void 0===t?void 0:t.owner._id)===(null===a||void 0===a?void 0:a._id),s="image-card__trash ".concat(o?"image-card__trash_visible":"image-card__trash_hidden"),c=null===(n=e.card)||void 0===n?void 0:n.likes.some((function(e){return e._id===(null===a||void 0===a?void 0:a._id)})),r="image-card__heart ".concat(c?"image-card__heart_liked":"");return Object(h.jsxs)("div",{className:"image-card",children:[Object(h.jsx)("button",{className:s,type:"button","aria-label":"trash button",onClick:function(){e.onDeleteCardClick(e.card)}}),Object(h.jsx)("img",{className:"image-card__image",src:e.link,alt:e.name,onClick:function(){e.onCardClick(e.card)}}),Object(h.jsxs)("div",{className:"image-card__text",children:[Object(h.jsx)("h2",{className:"image-card__title",children:e.name}),Object(h.jsxs)("div",{className:"image-card__heart-group",children:[Object(h.jsx)("button",{className:r,"aria-label":"Like button",type:"button",onClick:function(){e.onCardLike(e.card)}}),Object(h.jsx)("p",{className:"image-card__heart-number",children:e.likes})]})]})]})};var g=function(e){var t=i.a.useContext(p);return Object(h.jsxs)("main",{className:"main",children:[Object(h.jsxs)("section",{className:"profile",children:[Object(h.jsxs)("div",{className:"profile__details",children:[Object(h.jsxs)("div",{className:"profile__image-group",children:[Object(h.jsx)("button",{className:"profile__image-overlay",type:"button","aria-label":"profile image edit button",onClick:e.onEditAvatarClick}),Object(h.jsx)("img",{className:"profile__image",src:null===t||void 0===t?void 0:t.avatar,alt:"profile"})]}),Object(h.jsxs)("div",{className:"profile__info",children:[Object(h.jsxs)("div",{className:"profile__line-top",children:[Object(h.jsx)("h1",{className:"profile__title",children:null===t||void 0===t?void 0:t.name}),Object(h.jsx)("button",{className:"profile__button-edit",type:"button","aria-label":"edit button",onClick:e.onEditProfileClick})]}),Object(h.jsx)("p",{className:"profile__subtitle",children:null===t||void 0===t?void 0:t.about})]})]}),Object(h.jsx)("button",{className:"profile__button-add",type:"button","aria-label":"add button",onClick:e.onAddPlaceClick})]}),Object(h.jsx)("section",{className:"image-grid",children:e.cards.map((function(t){return Object(h.jsx)(_,{name:t.name,id:t._id,link:t.link,likes:t.likes.length,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onDeleteCardClick:e.onDeleteCardClick},t._id)}))})]})};var f=function(){return Object(h.jsx)("footer",{className:"footer",children:Object(h.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Around The U.S."})})};var v=function(e){return i.a.useEffect((function(){function t(t){"Escape"===t.key&&e.onClose()}return e.isOpen&&window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}}),[e]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_open":""),onClick:function(t){t.target.classList.contains("modal")&&(t.preventDefault(),e.onClose())},children:Object(h.jsxs)("div",{className:"modal__container",children:[Object(h.jsx)("button",{className:"modal__close-icon modal__close-icon_type_".concat(e.name),type:"button","aria-label":"close button",onClick:e.onClose}),Object(h.jsxs)("form",{className:"edit-box edit-box_type_".concat(e.name),name:"form-".concat(e.name),onSubmit:e.onSubmit,children:[Object(h.jsx)("h2",{className:"edit-box__title",children:e.title}),e.children,Object(h.jsx)("button",{className:"edit-box__button edit-box__button_edit",type:"submit","aria-label":"save button","data-textcontent":"Save",children:e.isLoading?e.loadingText:e.buttonText})]})]})})})};var x=function(e){var t=i.a.useContext(p),n=i.a.useState(),a=Object(r.a)(n,2),o=a[0],s=a[1],c=i.a.useState(),l=Object(r.a)(c,2),d=l[0],u=l[1];return i.a.useEffect((function(){s(null===t||void 0===t?void 0:t.name),u(null===t||void 0===t?void 0:t.about)}),[t,e.isOpen]),Object(h.jsx)(v,{name:"edit",title:"Edit profile",loadingText:"Saving...",buttonText:"Save changes",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onRenderLoading(),e.onUpdateUser({name:o,about:d})},isLoading:e.isLoading,children:Object(h.jsxs)("div",{className:"edit-box__inputs",children:[Object(h.jsxs)("div",{className:"edit-box__input-group",children:[Object(h.jsx)("input",{value:o||"",id:"title-input",className:"edit-box__input edit-box__input_type_title",type:"text",name:"username",placeholder:"Name",minLength:"2",maxLength:"40",onChange:function(e){s(e.target.value)},required:!0}),Object(h.jsx)("span",{id:"title-input-error",className:"edit-box__input-error"})]}),Object(h.jsxs)("div",{className:"edit-box__input-group",children:[Object(h.jsx)("input",{value:d||"",id:"subtitle-input",className:"edit-box__input edit-box__input_type_description",type:"text",name:"userdescription",placeholder:"Description",minLength:"2",maxLength:"200",onChange:function(e){u(e.target.value)},required:!0}),Object(h.jsx)("span",{id:"subtitle-input-error",className:"edit-box__input-error"})]})]})})};var O=function(e){var t=i.a.useState(),n=Object(r.a)(t,2),a=n[0],o=n[1],s=i.a.useState(),c=Object(r.a)(s,2),l=c[0],d=c[1];return Object(h.jsx)(v,{name:"add",title:"New place",loadingText:"Creating...",buttonText:"Create",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onRenderLoading(),e.onAddPlaceSubmit({name:a,link:l}),o(""),d("")},isLoading:e.isLoading,children:Object(h.jsxs)("div",{className:"edit-box__inputs",children:[Object(h.jsxs)("div",{className:"edit-box__input-group",children:[Object(h.jsx)("input",{value:a||"",id:"image-title-input",className:"edit-box__input edit-box__input_type_image-title",type:"text",name:"name",placeholder:"Title",minLength:"1",maxLength:"30",onChange:function(e){o(e.target.value)},required:!0}),Object(h.jsx)("span",{id:"image-title-input-error",className:"edit-box__input-error"})]}),Object(h.jsxs)("div",{className:"edit-box__input-group",children:[Object(h.jsx)("input",{value:l||"",id:"image-link-input",className:"edit-box__input edit-box__input_type_image-link",type:"url",name:"link",placeholder:"Image link",onChange:function(e){d(e.target.value)},required:!0}),Object(h.jsx)("span",{id:"image-link-input-error",className:"edit-box__input-error"})]})]})})};var k=function(e){var t=i.a.useRef();return Object(h.jsx)(v,{name:"profile-image",title:"Change profile picture",loadingText:"Saving...",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onRenderLoading(),e.onUpdateAvatar(t.current.value),t.current.value=""},isLoading:e.isLoading,children:Object(h.jsx)("div",{className:"edit-box__inputs",children:Object(h.jsxs)("div",{className:"edit-box__input-group",children:[Object(h.jsx)("input",{ref:t,id:"profile-image-link-input",className:"edit-box__input edit-box__input_type_image-link",type:"url",name:"profileimage",placeholder:"Image Link",required:!0}),Object(h.jsx)("span",{id:"profile-image-link-input-error",className:"edit-box__input-error"})]})})})};var C=function(e){return Object(h.jsx)(v,{name:"delete-card",title:"Are you sure?",loadingText:"Deleting...",buttonText:"Yes",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onRenderLoading(),e.onDeleteCardSubmit(e.cardToDelete)},isLoading:e.isLoading})};var N=function(e){var t,n,a;return i.a.useEffect((function(){function t(t){"Escape"===t.key&&e.onClose()}return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}}),[e]),Object(h.jsx)("div",{className:"modal image-expand ".concat(e.card?"modal_open":""),onClick:function(t){t.target.classList.contains("modal")&&(t.preventDefault(),e.onClose())},children:Object(h.jsxs)("div",{className:"image-expand__container",children:[Object(h.jsx)("button",{className:"modal__close-icon modal__close-icon_type_image",type:"button","aria-label":"close button",onClick:e.onClose}),Object(h.jsxs)("div",{className:"image-expand__info",children:[Object(h.jsx)("img",{src:null===(t=e.card)||void 0===t?void 0:t.link,className:"image-expand__image",alt:null===(n=e.card)||void 0===n?void 0:n.name}),Object(h.jsx)("h2",{className:"image-expand__title",children:null===(a=e.card)||void 0===a?void 0:a.name})]})]})})};n(36);var L=Object(l.h)((function(e){return Object(h.jsxs)("form",{className:"auth-container",onSubmit:e.onAuthorizationSubmit,children:[Object(h.jsxs)("div",{className:"upper-flex-container",children:[Object(h.jsx)("h2",{className:"auth-container__title",children:e.title}),Object(h.jsxs)("div",{className:"auth-container__inputs",children:[Object(h.jsxs)("div",{className:"auth-container__input-group",children:[Object(h.jsx)("input",{type:"text",name:"email",value:e.email,id:"auth-container__email-input",className:"auth-container__input",placeholder:"Email",onChange:e.onEmailChange}),Object(h.jsx)("span",{id:"auth-container__email-input-error",className:"auth-container__input-error"})]}),Object(h.jsxs)("div",{className:"auth-container__input-group",children:[Object(h.jsx)("input",{type:"text",name:"password",value:e.password,id:"auth-container__password-input",className:"auth-container__input",placeholder:"Password",onChange:e.onPasswordChange}),Object(h.jsx)("span",{id:"auth-container__password-input-error",className:"auth-container__input-error"})]})]})]}),Object(h.jsxs)("div",{className:"lower-flex-container",children:[Object(h.jsx)("button",{type:"submit",className:"auth-container__submit-button",onClick:e.onAuthorizationSubmit,children:e.buttonTitle}),Object(h.jsx)(d.b,{to:e.pageLink,className:"auth-container__switch-link",children:e.pageLinkTitle})]})]})}));var y=function(e){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j,{linkTitle:"Sign up",pageLink:"./register"}),Object(h.jsx)(L,{title:"Log in",buttonTitle:"Log in",pageLink:"./register",pageLinkTitle:"Not a member yet? Sign up here!",email:e.email,password:e.password,onEmailChange:e.onEmailChange,onPasswordChange:e.onPasswordChange,onAuthorizationSubmit:e.onLoginSubmit})]})};var S=function(e){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j,{linkTitle:"Log in",pageLink:"./login"}),Object(h.jsx)(L,{title:"Sign up",buttonTitle:"Sign up",pageLink:"./login",pageLinkTitle:"Already a member? Log in here!",email:e.email,password:e.password,onEmailChange:e.onEmailChange,onPasswordChange:e.onPasswordChange,onAuthorizationSubmit:e.onRegisterSubmit})]})},w=n(21),E=n(22),T=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(w.a)(this,e),this._baseUrl=n,this._headers=a}return Object(E.a)(e,[{key:"_returnRes",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getCardList",value:function(){var e=this;return fetch(this._baseUrl+"/cards",{method:"GET",headers:this._headers}).then((function(t){return e._returnRes(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseUrl+"/users/me",{method:"GET",headers:this._headers}).then((function(t){return e._returnRes(t)}))}},{key:"addLike",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then((function(e){return t._returnRes(e)}))}},{key:"removeLike",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then((function(e){return t._returnRes(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){t?this.removeLike(e):this.addLike(e)}},{key:"removeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then((function(e){return t._returnRes(e)}))}},{key:"setUserInfo",value:function(e){var t=this,n=e.name,a=e.about;return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:n,about:a})}).then((function(e){return t._returnRes(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return t._returnRes(e)}))}},{key:"addCard",value:function(e){var t=this,n=e.name,a=e.link;return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:n,link:a})}).then((function(e){return t._returnRes(e)}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"bf6a8c78-b245-4594-801d-fa3b505682c7","Content-Type":"application/json"}}),P=(n(37),n.p+"static/media/image-success.1b6082f8.svg"),U=n.p+"static/media/image-failure.df8eddf6.svg";var D=function(e){var t=i.a.useState(!0),n=Object(r.a)(t,2),a=n[0];return n[1],i.a.useEffect((function(){function t(t){"Escape"===t.key&&e.onClose()}return e.isOpen&&window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}}),[e]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"modal modal_type_info-tooltip ".concat(e.isOpen?"modal_open":""),onClick:function(t){t.target.classList.contains("modal")&&(t.preventDefault(),e.onClose())},children:Object(h.jsxs)("div",{className:"modal__container modal__container_type_info-tooltip",children:[Object(h.jsx)("button",{className:"modal__close-icon modal__close-icon_type_info-tooltip",type:"button","aria-label":"close button",onClick:e.onClose}),Object(h.jsxs)("div",{className:"info-tooltip",children:[Object(h.jsx)("img",{className:"info-tooltip__image",src:a?P:U,alt:""}),Object(h.jsx)("h2",{className:"info-tooltip__title",children:a?"Success! You have now been registered.":"Oops, something went wrong! Please try again."})]})]})})})},A=n(16),I=n(24),R=["children","loggedIn"];var F=function(e){var t=e.children,n=e.loggedIn,a=Object(I.a)(e,R);return Object(h.jsx)(l.b,Object(A.a)(Object(A.a)({},a),{},{children:n?t:Object(h.jsx)(l.a,{to:"/login"})}))},z="https://register.nomoreparties.co";var J=function(){var e=Object(l.g)(),t=i.a.useState(!1),n=Object(r.a)(t,2),a=n[0],o=n[1],s=i.a.useState(!1),d=Object(r.a)(s,2),u=d[0],m=d[1],b=i.a.useState(!1),_=Object(r.a)(b,2),v=_[0],L=_[1],w=i.a.useState(!1),E=Object(r.a)(w,2),P=E[0],U=E[1],A=i.a.useState(!1),I=Object(r.a)(A,2),R=I[0],J=I[1],q=i.a.useState(),B=Object(r.a)(q,2),G=B[0],H=B[1],M=i.a.useState(),Y=Object(r.a)(M,2),K=Y[0],Q=Y[1],V=i.a.useState([]),W=Object(r.a)(V,2),X=W[0],Z=W[1],$=i.a.useState(!1),ee=Object(r.a)($,2),te=ee[0],ne=ee[1],ae=i.a.useState(),ie=Object(r.a)(ae,2),oe=ie[0],se=ie[1],ce=i.a.useState(!0),re=Object(r.a)(ce,2),le=re[0],de=re[1],ue=i.a.useState(""),me=Object(r.a)(ue,2),be=me[0],he=me[1],je=i.a.useState(""),pe=Object(r.a)(je,2),_e=pe[0],ge=pe[1];function fe(){o(!1),m(!1),L(!1),U(!1),J(!1),H()}function ve(e){he(e.target.value)}function xe(e){ge(e.target.value)}function Oe(){ne(!0)}return i.a.useEffect((function(){T.getUserInfo().then((function(e){Q(e)})).catch((function(e){return console.log(e)}))}),[]),i.a.useEffect((function(){console.log(be),console.log(_e)})),i.a.useEffect((function(){T.getCardList().then((function(e){Z(e)})).catch((function(e){return console.log(e)}))}),[]),Object(h.jsx)(p.Provider,{value:K,children:Object(h.jsxs)(l.d,{children:[Object(h.jsxs)(F,{exact:!0,path:"/",loggedIn:le,children:[Object(h.jsx)(j,{loggedIn:le,pageLink:"/login",linkTitle:"Log out"}),Object(h.jsx)(g,{onCardClick:function(e){H(e)},onEditProfileClick:function(){ne(!1),o(!0)},onAddPlaceClick:function(){ne(!1),m(!0)},onEditAvatarClick:function(){ne(!1),L(!0)},cards:X,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===(null===K||void 0===K?void 0:K._id)}));t?T.removeLike(e._id,!t).then((function(t){Z((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)})):T.addLike(e._id,!t).then((function(t){Z((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)}))},onDeleteCardClick:function(e){ne(!1),U(!0),se(e)}}),Object(h.jsx)(f,{}),Object(h.jsx)(x,{isOpen:a,onClose:fe,onUpdateUser:function(e){T.setUserInfo(e).then((function(e){Q(e),fe()})).catch((function(e){return console.log(e)}))},isLoading:te,onRenderLoading:Oe}),Object(h.jsx)(O,{isOpen:u,onClose:fe,onAddPlaceSubmit:function(e){var t=e.link,n=e.name;T.addCard({link:t,name:n}).then((function(e){Z([e].concat(Object(c.a)(X))),fe()})).catch((function(e){return console.log(e)}))},isLoading:te,onRenderLoading:Oe}),Object(h.jsx)(k,{isOpen:v,onClose:fe,onUpdateAvatar:function(e){T.setUserAvatar(e).then((function(e){Q(e),fe()})).catch((function(e){return console.log(e)}))},isLoading:te,onRenderLoading:Oe}),Object(h.jsx)(C,{cardToDelete:oe,isOpen:P,onClose:fe,onDeleteCardSubmit:function(e){T.removeCard(e._id).then((function(){Z((function(t){return t.filter((function(t){return t._id!==e._id}))})),fe()})).catch((function(e){return console.log(e)}))},isLoading:te,onRenderLoading:Oe}),Object(h.jsx)(N,{card:G,onClose:fe})]}),Object(h.jsx)(l.b,{path:"/login",children:Object(h.jsx)(y,{email:be,password:_e,setEmail:he,setPassword:ge,onEmailChange:ve,onPasswordChange:xe,onLoginSubmit:function(t){t.preventDefault(),function(e,t){return fetch("".concat(z,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({identifier:e,password:t})}).then((function(e){return e.json()})).then((function(e){return console.log(e),e.token?(localStorage.setItem("token",e.token),console.log(e.token),e):void 0})).catch((function(e){return console.log(e)}))}(be,_e).then((function(t){t.token&&(he(""),ge(""),function(e){e.preventDefault(),de(!0)}(),e.push("/"))})).catch((function(e){return console.log(e)}))}})}),Object(h.jsxs)(l.b,{path:"/register",children:[Object(h.jsx)(S,{email:be,password:_e,setEmail:he,setPassword:ge,onEmailChange:ve,onPasswordChange:xe,onRegisterSubmit:function(t){t.preventDefault(),function(e,t){return fetch("".concat(z,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)}))}(be,_e).then((function(t){t?e.push("/login"):console.log("Something went wrong")})),J(!0)}}),Object(h.jsx)(D,{isOpen:R,onClose:fe})]})]})})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),i(e),o(e),s(e)}))};s.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(d.a,{basename:"react-around-auth",children:Object(h.jsx)(J,{})})}),document.getElementById("root")),q()}},[[38,1,2]]]);
//# sourceMappingURL=main.9b41fb77.chunk.js.map